"use strict";(self.webpackChunkfruit_app=self.webpackChunkfruit_app||[]).push([[1622],{21622:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var n=a(65043),o=a(46909),s=a(23927),r=a(22019),d=a(3188),i=a(6051),l=a(27210),c=a(49757),u=a(62058),p=a(9855),m=a(1457),y=a(86213),A=a(86178),x=a.n(A),h=a(11238),k=a(1880),b=a(86111),j=a.n(b),f=a(70579);const{confirm:v}=o.A,{Title:C}=s.A,g="https://majesticmall.net/api/admin",_=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)([]),[A,b]=(0,n.useState)(""),[_,S]=(0,n.useState)(!1),[w,I]=(0,n.useState)(null),T=k.A.get("token"),$=T?j().AES.decrypt(T,"Abhinanadan02").toString(j().enc.Utf8):null;(0,n.useEffect)((()=>{Y()}),[]);const Y=async()=>{try{var e;const a=await y.A.get(`${g}/getAbandoned`),n=E(null===(e=a.data)||void 0===e?void 0:e.abandonedCarts);t(n),s(n)}catch(a){r.Ay.error("Failed to fetch abandoned carts")}},E=e=>null===e||void 0===e?void 0:e.map(((e,t)=>{var a;return{key:t+1,user:(null===(a=e.user)||void 0===a?void 0:a.name)||"Anonymous",cartItems:e.cart.map((e=>`${e.productname} (x${e.quantity})`)).join(", "),timestamp:x()(e.timestamp).format("DD/MM/YYYY, HH:mm"),_id:e._id}})),z=async()=>{try{await y.A.delete(`${g}/deleteAbandoned/${w}`,{headers:{Authorization:`Bearer ${$}`}}),r.Ay.success("Abandoned cart deleted successfully"),S(!1),Y()}catch(e){r.Ay.error("Failed to delete abandoned cart")}},D=[{title:"SNo",dataIndex:"key",key:"key"},{title:"User",dataIndex:"user",key:"user"},{title:"Cart Items",dataIndex:"cartItems",key:"cartItems"},{title:"Timestamp",dataIndex:"timestamp",key:"timestamp"},{title:"Action",key:"action",render:(e,t)=>(0,f.jsx)(d.Ay,{type:"text",icon:(0,f.jsx)(p.A,{color:"red"}),onClick:()=>{I(t._id),S(!0)}})}];return(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[(0,f.jsx)(C,{level:3,children:"Abandoned Carts"}),(0,f.jsxs)(i.A,{children:[(0,f.jsx)(l.A,{placeholder:"Search",prefix:(0,f.jsx)(u.A,{}),value:A,onChange:t=>(t=>{b(t);const a=e.filter((e=>Object.values(e).some((e=>e&&e.toString().toLowerCase().includes(t.toLowerCase())))));s(a)})(t.target.value)}),(0,f.jsx)(d.Ay,{type:"primary",icon:(0,f.jsx)(m.A,{size:16}),onClick:()=>{const e=a.map((e=>{let{key:t,_id:a,...n}=e;return n})),t=h.Wp.json_to_sheet(e),n=h.Wp.book_new();h.Wp.book_append_sheet(n,t,"Abandoned Carts"),h._h(n,"Abandoned_Carts.xlsx")},children:"Export to Excel"})]})]}),(0,f.jsx)(c.A,{columns:D,dataSource:a,pagination:{pageSize:10},scroll:{x:"max-content"},components:{header:{cell:e=>(0,f.jsx)("th",{...e,style:{...e.style,background:"linear-gradient(#000,#000,#000)",color:"white"}})}}}),(0,f.jsx)(o.A,{title:"Delete Abandoned Cart",visible:_,onOk:e=>{v({title:"Are you sure you want to delete?",content:"This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk(){z(e)},onCancel(){}})},onCancel:()=>S(!1),children:(0,f.jsx)("p",{children:"Are you sure you want to delete this abandoned cart?"})})]})}}}]);
//# sourceMappingURL=1622.605c0423.chunk.js.map