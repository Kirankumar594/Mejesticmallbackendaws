"use strict";(self.webpackChunkfruit_app=self.webpackChunkfruit_app||[]).push([[4829],{44829:(e,t,a)=>{a.r(t),a.d(t,{default:()=>$});var r=a(65043),o=a(46909),s=a(23927),i=a(59748),c=a(22019),n=a(6051),l=a(3188),d=a(27210),y=a(49757),g=a(6036),m=a(62058),u=a(75337),h=a(26533),p=a(9855),A=a(1457),x=a(86213),j=a(11238),C=a(1880),f=a(86111),N=a.n(f),b=a(70579);const{confirm:v}=o.A,k="https://majesticmall.net/api/admin",{Title:w}=s.A,S=[{categoryName:"Grocery & Staples"},{categoryName:"Milk & Dairy Products"},{categoryName:"Fruits & Vegetables"}],$=()=>{const[e,t]=(0,r.useState)([]),[a,s]=(0,r.useState)(!1),[f,$]=(0,r.useState)(!1),[T,F]=(0,r.useState)(null),[I]=i.A.useForm(),[_,z]=(0,r.useState)(""),[B,U]=(0,r.useState)([]),E=C.A.get("token"),L=E?N().AES.decrypt(E,"Abhinanadan02").toString(N().enc.Utf8):null;(0,r.useEffect)((()=>{P()}),[]),(0,r.useEffect)((()=>{U(e.filter((e=>Object.values(e).some((e=>e&&e.toString().toLowerCase().includes(_.toLowerCase()))))))}),[e,_]);const P=async()=>{try{const e=await x.A.get(`${k}/getCategory`,{headers:{Authorization:`Bearer ${L}`}});t(e.data.category)}catch(e){c.Ay.error("Failed to fetch categories")}},q=e.length,D=(e,t)=>{S.some((e=>e.categoryName===t))?c.Ay.error("This category cannot be deleted as it is a predefined category"):v({title:"Are you sure you want to delete?",content:"This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk(){(async(e,t)=>{if(S.some((e=>e.categoryName===t)))c.Ay.error("This category cannot be deleted as it is a predefined category");else try{await x.A.delete(`${k}/deleteCategory/${e}`,{headers:{Authorization:`Bearer ${L}`}}),c.Ay.success("Category deleted successfully"),P()}catch(a){c.Ay.error("Failed to delete category")}})(e,t)},onCancel(){}})},[W,O]=(0,r.useState)({current:1,pageSize:10}),V=[{title:"Serial No.",key:"serialNo",render:(e,t,a)=>(W.current-1)*W.pageSize+a+1},{title:"Category Image",dataIndex:"categoryimage",key:"categoryimage",render:e=>(0,b.jsx)("img",{src:`https://majesticmall.net/image/${e}`,alt:"Category",loading:"lazy",style:{width:80,height:80}})},{title:`Category (${q})`,dataIndex:"categoryName",key:"categoryName"},{title:"Action",key:"action",render:(e,t)=>(0,b.jsxs)(n.A,{children:[(0,b.jsx)(l.Ay,{type:"text",icon:(0,b.jsx)(h.A,{color:"blue"}),onClick:()=>{F(t),$(!0),I.setFieldsValue(t)}}),(0,b.jsx)(l.Ay,{type:"text",icon:(0,b.jsx)(p.A,{color:"red"}),onClick:()=>D(t._id,null===t||void 0===t?void 0:t.categoryName)}),(0,b.jsx)(l.Ay,{type:"Active"===t.status?"primary":"danger",onClick:()=>(async e=>{try{const t="Active"===e.status?"changecategoryActiveStatus":"changecategoryInactiveStatus";await x.A.get(`https://majesticmall.net/api/admin/${t}/${e._id}`,{headers:{Authorization:`Bearer ${L}`}}),c.Ay.success(`Category ${"Active"===e.status?"blocked":"unblocked"} successfully`),P()}catch(t){c.Ay.error("Failed to update product status")}})(t),children:"Active"===t.status?"Active":"Inactive"})]})}];return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[(0,b.jsx)(w,{level:3,className:"title",children:"Categories"}),(0,b.jsxs)(n.A,{children:[(0,b.jsx)(d.A,{placeholder:"Search categories",prefix:(0,b.jsx)(m.A,{}),value:_,onChange:e=>z(e.target.value)}),(0,b.jsx)(l.Ay,{type:"primary",icon:(0,b.jsx)(u.A,{}),onClick:()=>s(!0),children:"Add Category"}),(0,b.jsx)(l.Ay,{type:"primary",icon:(0,b.jsx)(A.A,{size:16}),onClick:()=>{const e=B.map((e=>{let{_id:t,categoryName:a,categoryimage:r}=e;return{"Category Name":a,"Image URL":`https://majesticmall.net/image/${r}`}})),t=j.Wp.json_to_sheet(e),a=j.Wp.book_new();j.Wp.book_append_sheet(a,t,"Categories"),j._h(a,"categories.xlsx")},children:"Export to Excel"})]})]}),(0,b.jsx)(y.A,{columns:V,dataSource:B,rowKey:"_id",pagination:{...W,onChange:(e,t)=>{O({current:e,pageSize:t})}},scroll:{x:"max-content"},components:{header:{cell:e=>(0,b.jsx)("th",{...e,style:{...e.style,background:"linear-gradient(#000,#000,#000)",color:"white"}})}}}),(0,b.jsx)(o.A,{title:"Add Category",visible:a,onCancel:()=>s(!1),footer:null,children:(0,b.jsxs)(i.A,{form:I,onFinish:async e=>{if(S.some((t=>t.categoryName.toLowerCase()===e.categoryName.toLowerCase())))c.Ay.error("This category name is reserved and cannot be added");else try{const t=new FormData;t.append("categoryName",e.categoryName),t.append("categoryimage",e.categoryimage.file),await x.A.post(`${k}/addCategory`,t,{headers:{"Content-Type":"multipart/form-data"},headers:{Authorization:`Bearer ${L}`}},{headers:{Authorization:`Bearer ${L}`}}),c.Ay.success("Category added successfully"),s(!1),I.resetFields(),P()}catch(t){c.Ay.error("Failed to add category")}},layout:"vertical",children:[(0,b.jsx)(i.A.Item,{name:"categoryName",label:"Category Name",rules:[{required:!0,message:"Please enter a category name"}],children:(0,b.jsx)(d.A,{})}),(0,b.jsx)(i.A.Item,{name:"categoryimage",label:"Category Image",rules:[{required:!0,message:"Please upload a category image"}],children:(0,b.jsx)(g.A,{accept:"image/*",listType:"picture-card",maxCount:1,beforeUpload:()=>!1,children:(0,b.jsxs)("div",{children:[(0,b.jsx)(u.A,{}),(0,b.jsx)("div",{style:{marginTop:8},children:"Upload"})]})})}),(0,b.jsx)(i.A.Item,{children:(0,b.jsx)(l.Ay,{type:"primary",htmlType:"submit",children:"Add Category"})})]})}),(0,b.jsx)(o.A,{title:"Edit Category",visible:f,onCancel:()=>$(!1),footer:null,children:(0,b.jsxs)(i.A,{form:I,onFinish:async e=>{if(S.some((e=>e.categoryName===T.categoryName))&&e.categoryName!==T.categoryName)c.Ay.error("Cannot change the name of predefined categories");else try{const t=new FormData;t.append("categoryName",e.categoryName),e.categoryimage&&e.categoryimage.file&&t.append("categoryimage",e.categoryimage.file),await x.A.post(`${k}/editCategory/${T._id}`,t,{headers:{"Content-Type":"multipart/form-data"},headers:{Authorization:`Bearer ${L}`}},{headers:{Authorization:`Bearer ${L}`}}),c.Ay.success("Category updated successfully"),$(!1),I.resetFields(),P()}catch(t){c.Ay.error("Failed to update category")}},layout:"vertical",children:[(0,b.jsx)(i.A.Item,{name:"categoryName",label:"Category Name",rules:[{required:!0,message:"Please enter a category name"}],children:(0,b.jsx)(d.A,{})}),(0,b.jsx)(i.A.Item,{name:"categoryimage",label:"Category Image",children:(0,b.jsx)(g.A,{accept:"image/*",listType:"picture-card",maxCount:1,beforeUpload:()=>!1,children:(0,b.jsxs)("div",{children:[(0,b.jsx)(u.A,{}),(0,b.jsx)("div",{style:{marginTop:8},children:"Upload"})]})})}),(0,b.jsx)(i.A.Item,{children:(0,b.jsx)(l.Ay,{type:"primary",htmlType:"submit",children:"Update Category"})})]})})]})}}}]);
//# sourceMappingURL=4829.3f26a440.chunk.js.map