"use strict";(self.webpackChunkfruit_app=self.webpackChunkfruit_app||[]).push([[6050],{16050:(e,t,i)=>{i.r(t),i.d(t,{default:()=>z});var s=i(65043),r=i(63336),a=i(12110),n=i(15316),l=i(68903),c=i(53193),o=i(79190),d=i(47715),u=i(32143),h=i(15795),x=i(11906),m=i(26494),A=i(17392),g=i(39336),p=i(71360),j=i(9855),v=i(50797),y=i(34535),b=i(68424),f=i(31517),S=i(80726),C=i.n(S),P=i(86213),k=i(78745),w=i(23927),R=i(22019),B=i(1880),W=i(86111),N=i.n(W),D=i(70579);const{Title:T}=w.A,U=(0,y.Ay)(r.A)((e=>{let{theme:t}=e;return{border:`2px dashed ${t.palette.divider}`,padding:t.spacing(4),textAlign:"center",cursor:"pointer",marginBottom:t.spacing(2),"&:hover":{borderColor:t.palette.primary.main}}})),E=(0,y.Ay)(a.A)((e=>{let{theme:t}=e;return{marginBottom:t.spacing(1)}})),z=()=>{const[e,t]=(0,s.useState)([]),[i,y]=(0,s.useState)([]),[S,W]=(0,s.useState)([]),[z,M]=(0,s.useState)([]),I=B.A.get("token"),$=I?N().AES.decrypt(I,"Abhinanadan02").toString(N().enc.Utf8):null,[_,F]=(0,s.useState)(""),[O,L]=(0,s.useState)(""),[V,q]=(0,s.useState)(""),[Q,G]=(0,s.useState)(""),[H,J]=(0,s.useState)(""),[K,X]=(0,s.useState)(""),[Y,Z]=(0,s.useState)(""),[ee,te]=(0,s.useState)(""),[ie,se]=(0,s.useState)(""),[re,ae]=(0,s.useState)(""),[ne,le]=(0,s.useState)(""),[ce,oe]=(0,s.useState)(""),[de,ue]=(0,s.useState)(""),[he,xe]=(0,s.useState)([]),[me,Ae]=(0,s.useState)({value:"",price:"",units:"",stock:"",minStock:""}),[ge,pe]=(0,s.useState)([]),[je,ve]=(0,s.useState)([]),{getRootProps:ye,getInputProps:be}=(0,b.VB)({onDrop:e=>xe([...he,...e]),accept:"image/*,video/*"}),[fe,Se]=(0,s.useState)({}),[Ce,Pe]=(0,s.useState)({});(0,s.useEffect)((()=>{(async()=>{try{var e,i;const s=await P.A.get("https://majesticmall.net/api/admin/getCategory",{headers:{Authorization:`Bearer ${$}`}});t(null===(e=s.data)||void 0===e?void 0:e.category.filter((e=>"Active"===e.status)));const r={};null===(i=s.data)||void 0===i||i.category.filter((e=>"Active"===e.status)).forEach((e=>{r[e._id]=e.categoryName})),Se(r)}catch(s){k.oR.error("Error fetching categories")}})(),(async()=>{try{var e,t;const i=await P.A.get("https://majesticmall.net/api/admin/getSubcategory",{headers:{Authorization:`Bearer ${$}`}});y(null===(e=i.data)||void 0===e?void 0:e.Subcategory.filter((e=>"Active"===e.status)));const s={};null===(t=i.data)||void 0===t||t.Subcategory.filter((e=>"Active"===e.status)).forEach((e=>{s[e._id]=e.SubcategoryName})),Pe(s)}catch(i){k.oR.error("Error fetching subcategories")}})(),(async()=>{try{var e;const t=await P.A.get("https://majesticmall.net/api/admin/getTag",{headers:{Authorization:`Bearer ${$}`}});W(null===(e=t.data)||void 0===e?void 0:e.Tag)}catch(t){k.oR.error("Error fetching tags")}})(),(async()=>{try{var e;const t=await P.A.get("https://majesticmall.net/api/admin/getUnit",{headers:{Authorization:`Bearer ${$}`}});M(null===(e=t.data)||void 0===e?void 0:e.Unit)}catch(t){k.oR.error("Error fetching units")}})()}),[$]);const ke=async e=>{const t=new FormData;try{for(let i=0;i<he.length;i++)t.append("id",e),t.append("Photos",he[i]),await fetch("https://majesticmall.net/api/admin/addPhotos/",{method:"post",headers:{Authorization:`Bearer ${$}`},body:t});setTimeout((()=>{window.location.assign("/admindashboard/list-product")}),500)}catch(i){k.oR.error("Error uploading images")}},we=(e,t)=>(e-e*t/100).toFixed(2);return(0,D.jsxs)(n.A,{sx:{p:3},children:[(0,D.jsx)(T,{level:3,className:"title",children:"Add Product"}),(0,D.jsxs)(l.Ay,{container:!0,spacing:3,children:[(0,D.jsx)(l.Ay,{item:!0,xs:12,children:(0,D.jsxs)(r.A,{sx:{p:3},children:[(0,D.jsx)(w.A,{variant:"h6",gutterBottom:!0,className:"mb-2",children:"Basic Information"}),(0,D.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,D.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,D.jsxs)(c.A,{fullWidth:!0,children:[(0,D.jsx)(o.A,{children:"Category"}),(0,D.jsxs)(d.A,{value:V,onChange:e=>q(e.target.value),label:"Category",children:[(0,D.jsx)(u.A,{value:"",children:"Select Category"}),e.map(((e,t)=>(0,D.jsx)(u.A,{value:e._id,children:e.categoryName},t)))]})]})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,D.jsxs)(c.A,{fullWidth:!0,children:[(0,D.jsx)(o.A,{children:"Sub-Category"}),(0,D.jsxs)(d.A,{value:Q,onChange:e=>G(e.target.value),label:"Sub-Category",children:[(0,D.jsx)(u.A,{value:"",children:"Select Sub-Category"}),i.filter((e=>e.categoryId===V)).map(((e,t)=>(0,D.jsx)(u.A,{value:e._id,children:e.SubcategoryName},t)))]})]})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,D.jsxs)(c.A,{fullWidth:!0,children:[(0,D.jsx)(o.A,{children:"Product Type"}),(0,D.jsxs)(d.A,{value:ce,onChange:e=>oe(e.target.value),label:"Product Type",children:[(0,D.jsx)(u.A,{value:"",children:"Select Type"}),(0,D.jsx)(u.A,{value:"Normal",children:"Normal"}),(0,D.jsx)(u.A,{value:"Subscription",children:"Subscription"})]})]})})]})]})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,children:(0,D.jsxs)(r.A,{sx:{p:3},children:[(0,D.jsx)(w.A,{variant:"h6",gutterBottom:!0,className:"mb-2",children:"Product Details"}),(0,D.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,D.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,D.jsx)(h.A,{fullWidth:!0,type:"text",label:"Product Title",value:_,onChange:e=>F(e.target.value)})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,D.jsx)(h.A,{fullWidth:!0,type:"number",label:"Product Price",inputProps:{min:"1"},value:O,onChange:e=>L(e.target.value)})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,D.jsxs)(c.A,{fullWidth:!0,children:[(0,D.jsx)(o.A,{children:"Product Tag"}),(0,D.jsxs)(d.A,{value:H,onChange:e=>J(e.target.value),label:"Product Tag",children:[(0,D.jsx)(u.A,{value:"",children:"Select Tag"}),S.map(((e,t)=>(0,D.jsx)(u.A,{value:e.tag,children:e.tag},t)))]})]})})]})]})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,children:(0,D.jsxs)(r.A,{sx:{p:3},children:[(0,D.jsx)(w.A,{variant:"h6",gutterBottom:!0,children:"Stock Management"}),(0,D.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,D.jsx)(l.Ay,{item:!0,xs:12,md:6,children:(0,D.jsx)(h.A,{fullWidth:!0,type:"number",label:"Stock",inputProps:{min:"1"},value:ee,onChange:e=>te(e.target.value)})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,md:6,children:(0,D.jsx)(h.A,{fullWidth:!0,type:"number",label:"Minimum Stock",inputProps:{min:"1"},value:ie,onChange:e=>se(e.target.value)})})]})]})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,children:(0,D.jsxs)(r.A,{sx:{p:3},children:[(0,D.jsx)(w.A,{variant:"h6",gutterBottom:!0,className:"mb-2",children:"Pricing Options"}),(0,D.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,D.jsx)(l.Ay,{item:!0,xs:12,md:6,children:(0,D.jsx)(h.A,{fullWidth:!0,type:"number",label:"Normal Member Discount (%)",value:K,inputProps:{min:"0"},onChange:e=>X(e.target.value)})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,md:6,children:(0,D.jsx)(h.A,{fullWidth:!0,type:"number",label:"Club Member Discount (%)",value:Y,inputProps:{min:"0"},onChange:e=>Z(e.target.value)})})]}),(0,D.jsx)(n.A,{sx:{mt:3},children:(0,D.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,D.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,D.jsx)(h.A,{fullWidth:!0,type:"number",label:"Weight/Volume",value:me.value,inputProps:{min:"1"},onChange:e=>Ae({...me,value:e.target.value})})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,D.jsxs)(c.A,{fullWidth:!0,children:[(0,D.jsx)(o.A,{children:"Units"}),(0,D.jsxs)(d.A,{value:me.units,onChange:e=>Ae({...me,units:e.target.value}),label:"Units",children:[(0,D.jsx)(u.A,{value:"",children:"Select Units"}),z.map(((e,t)=>(0,D.jsx)(u.A,{value:e.unit,children:e.unit},t)))]})]})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,D.jsx)(h.A,{fullWidth:!0,type:"number",label:"Price",value:me.price,inputProps:{min:"1"},onChange:e=>Ae({...me,price:e.target.value})})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,D.jsx)(h.A,{fullWidth:!0,type:"number",label:"Stock Quantity",value:me.stock,inputProps:{min:"1"},onChange:e=>Ae({...me,stock:e.target.value})})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,D.jsx)(h.A,{fullWidth:!0,type:"number",label:"Min Stock Alert",inputProps:{min:"1"},value:me.minStock,onChange:e=>Ae({...me,minStock:e.target.value})})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,D.jsx)(x.A,{variant:"contained",startIcon:(0,D.jsx)(p.A,{}),fullWidth:!0,onClick:()=>{if(me.value&&me.price&&me.units&&K&&Y){const e=we(Number(me.price),Number(K)),t=we(Number(me.price),Number(Y)),i={...me,discountedPrice:e,id:Date.now()},s={...me,discountedPrice:t,id:Date.now()};pe([...ge,i]),ve([...je,s]),Ae({value:"",price:"",units:"",stock:"",minStock:""})}else k.oR.info("Please fill in all option details and discounts")},sx:{height:"56px"},style:{backgroundColor:"#000"},children:"Add Option"})})]})}),ge.length>0&&(0,D.jsxs)(n.A,{sx:{mt:3},children:[(0,D.jsx)(w.A,{variant:"subtitle1",gutterBottom:!0,children:"Normal Members Preview"}),ge.map((e=>(0,D.jsx)(E,{children:(0,D.jsxs)(m.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,D.jsxs)(w.A,{children:[e.value," ",e.units," - Rs ",e.price," ","(Discounted: Rs ",e.discountedPrice,")",(0,D.jsx)("br",{}),(0,D.jsxs)("small",{children:["Stock: ",e.stock," | Min Stock Alert:"," ",e.minStock]})]}),(0,D.jsx)(A.A,{onClick:()=>{return t=e.id,void pe(ge.filter((e=>e.id!==t)));var t},color:"error",children:(0,D.jsx)(j.A,{})})]})},e.id)))]}),je.length>0&&(0,D.jsxs)(n.A,{sx:{mt:3},children:[(0,D.jsxs)(w.A,{variant:"subtitle1",gutterBottom:!0,children:["Club Members Preview",(0,D.jsx)(g.A,{sx:{my:1}})]}),je.map((e=>(0,D.jsx)(E,{children:(0,D.jsxs)(m.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,D.jsxs)(n.A,{children:[(0,D.jsxs)(w.A,{variant:"subtitle2",children:[e.value," ",e.units]}),(0,D.jsxs)(w.A,{color:"textSecondary",children:["Original Price: Rs ",e.price]}),(0,D.jsxs)(w.A,{color:"primary",children:["Club Discounted Price: Rs ",e.discountedPrice]}),(0,D.jsxs)(w.A,{variant:"body2",color:"textSecondary",children:["Stock: ",e.stock," | Min Stock Alert:"," ",e.minStock]})]}),(0,D.jsx)(A.A,{onClick:()=>{return t=e.id,void ve(je.filter((e=>e.id!==t)));var t},color:"error",children:(0,D.jsx)(j.A,{})})]})},e.id)))]})]})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,children:(0,D.jsxs)(r.A,{sx:{p:3},children:[(0,D.jsx)(w.A,{variant:"h6",gutterBottom:!0,children:"Product Description"}),(0,D.jsx)(f.aF,{editor:C(),data:de,onChange:(e,t)=>{const i=t.getData();ue(i)}})]})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,children:(0,D.jsxs)(r.A,{sx:{p:3},children:[(0,D.jsx)(w.A,{variant:"h6",gutterBottom:!0,children:"Product Images"}),(0,D.jsxs)(U,{...ye(),children:[(0,D.jsx)("input",{...be()}),(0,D.jsx)(v.A,{size:40,className:"mx-auto mb-2"}),(0,D.jsx)(w.A,{children:"Drag & drop files here, or click to select files"}),(0,D.jsx)(w.A,{variant:"body2",color:"textSecondary",children:"Supports images and videos"})]}),he.length>0&&(0,D.jsx)(l.Ay,{container:!0,spacing:2,children:he.map(((e,t)=>(0,D.jsx)(l.Ay,{item:!0,xs:6,sm:4,md:3,children:(0,D.jsx)(a.A,{children:(0,D.jsxs)(n.A,{sx:{position:"relative"},children:[e.type.startsWith("video/")?(0,D.jsx)("video",{src:URL.createObjectURL(e),controls:!0,style:{width:"100%",height:"200px",objectFit:"cover"}}):(0,D.jsx)(n.A,{component:"img",src:URL.createObjectURL(e),alt:`Upload ${t+1}`,sx:{width:"100%",height:"200px",objectFit:"cover"}}),(0,D.jsx)(A.A,{sx:{position:"absolute",top:8,right:8,backgroundColor:"rgba(255, 255, 255, 0.8)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.9)"}},onClick:()=>{const e=[...he];e.splice(t,1),xe(e)},children:(0,D.jsx)(j.A,{size:20})})]})})},t)))})]})}),(0,D.jsx)(l.Ay,{item:!0,xs:12,children:(0,D.jsx)(n.A,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,D.jsx)(x.A,{variant:"contained",size:"large",onClick:async()=>{if(_&&O&&de&&V&&Q&&H)if(0!==ge.length&&0!==je.length)if(he.length<1)k.oR.info("Please add at least one image");else try{const t={productname:_,price:O,description:de,category:V,subcategory:Q,tag:H,discount:K,clubdiscount:Y,stock:ee,unit:re,miniunit:ne,ministock:ie,weight:ge,subscribe:ce,Clubweight:je},i=await P.A.post("https://majesticmall.net/api/admin/addProduct",t,{headers:{Authorization:`Bearer ${$}`}});var e;if(200===i.status)await ke(null===(e=i.data.product)||void 0===e?void 0:e._id),k.oR.success("Product added successfully")}catch(s){var t,i;R.Ay.error((null===(t=s.response)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.error)||"Error adding product")}else k.oR.info("Please add weight and price options for both normal and club members");else k.oR.info("Please fill in all required fields.")},startIcon:(0,D.jsx)(p.A,{}),style:{backgroundColor:"#000"},children:"Add Product"})})})]})]})}}}]);
//# sourceMappingURL=6050.9653fd9a.chunk.js.map