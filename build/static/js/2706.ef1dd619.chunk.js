"use strict";(self.webpackChunkfruit_app=self.webpackChunkfruit_app||[]).push([[2706],{72706:(e,t,a)=>{a.r(t),a.d(t,{default:()=>D});var o=a(65043),n=a(23927),s=a(46909),r=a(59748),d=a(22019),l=a(3188),i=a(6051),c=a(27210),u=a(49757),p=a(97107),h=a(67407),m=a(61966),A=a(62058),y=a(75337),x=a(86213),j=a(86178),v=a.n(j),f=a(11238),g=a(1457),C=a(1880),k=a(86111),w=a.n(k),Y=a(70579);const{Title:b}=n.A,D=()=>{const e=C.A.get("token"),t=e?w().AES.decrypt(e,"Abhinanadan02").toString(w().enc.Utf8):null,{confirm:a}=s.A,[n,j]=(0,o.useState)([]),[k,D]=(0,o.useState)([]),[_,S]=(0,o.useState)(""),[E,I]=(0,o.useState)(!1),[M,F]=(0,o.useState)(null),[z]=r.A.useForm();(0,o.useEffect)((()=>{$()}),[]);const $=async()=>{try{const o=await x.A.get("https://majesticmall.net/api/admin/getallpromocode",{headers:{Authorization:`Bearer ${t}`}});var e,a;if(200===o.status)j(null===(e=o.data)||void 0===e?void 0:e.promocode),D(null===(a=o.data)||void 0===a?void 0:a.promocode)}catch(o){console.error("Error fetching coupons:",o),d.Ay.error("Failed to fetch coupons")}},B=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;F(e),e?z.setFieldsValue({...e,startdate:v()(e.startdate),enddate:v()(e.enddate)}):z.resetFields(),I(!0)},T=()=>{I(!1),F(null),z.resetFields()},q=async e=>{try{200===(await x.A.delete(`https://majesticmall.net/api/admin/deletepromocode/${e}`,{headers:{Authorization:`Bearer ${t}`}})).status&&(d.Ay.success("Coupon deleted successfully"),$())}catch(a){console.error("Error deleting coupon:",a),d.Ay.error("Failed to delete coupon")}},H=[{title:"Name",dataIndex:"promocode",key:"promocode"},{title:"Discount (%)",dataIndex:"discountpercentage",key:"discountpercentage"},{title:"Start Date",dataIndex:"startdate",key:"startdate",render:e=>v()(e).format("DD/MM/YYYY")},{title:"End Date",dataIndex:"enddate",key:"enddate",render:e=>v()(e).format("DD/MM/YYYY")},{title:"Coupon Code",dataIndex:"code",key:"code"},{title:"Action",key:"action",render:(e,t)=>(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(l.Ay,{icon:(0,Y.jsx)(h.A,{}),onClick:()=>B(t)}),(0,Y.jsx)(l.Ay,{icon:(0,Y.jsx)(m.A,{}),onClick:()=>{return e=t._id,void a({title:"Are you sure you want to delete?",content:"This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk(){q(e)},onCancel(){}});var e},style:{marginLeft:8}})]})}];return(0,Y.jsxs)("div",{style:{padding:24},children:[(0,Y.jsxs)("div",{style:{marginBottom:16,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,Y.jsx)(b,{level:3,children:"Coupon Management"}),(0,Y.jsxs)(i.A,{children:[(0,Y.jsx)(c.A,{placeholder:"Search coupons",onChange:e=>(e=>{S(e);const t=n.filter((t=>Object.values(t).some((t=>null===t||void 0===t?void 0:t.toString().toLowerCase().includes(e.toLowerCase())))));D(t)})(e.target.value),prefix:(0,Y.jsx)(A.A,{}),style:{width:200}}),(0,Y.jsx)(l.Ay,{type:"primary",onClick:()=>{const e=k.map((e=>{let{_id:t,__v:a,used:o,...n}=e;return n})),t=f.Wp.json_to_sheet(e),a=f.Wp.book_new();f.Wp.book_append_sheet(a,t,"Coupons"),f._h(a,"Coupons.xlsx")},icon:(0,Y.jsx)(g.A,{size:16}),children:"Export to Excel"}),(0,Y.jsx)(l.Ay,{type:"primary",icon:(0,Y.jsx)(y.A,{}),onClick:()=>B(),children:"Add Coupon"})]})]}),(0,Y.jsx)(u.A,{columns:H,dataSource:k,rowKey:"_id"}),(0,Y.jsx)(s.A,{title:M?"Edit Coupon":"Add Coupon",visible:E,onCancel:T,footer:null,children:(0,Y.jsxs)(r.A,{form:z,onFinish:async e=>{try{const a={...e,startdate:e.startdate.format("YYYY-MM-DD"),enddate:e.enddate.format("YYYY-MM-DD")};let o;o=M?await x.A.post(`https://majesticmall.net/api/admin/editpromocode/${M._id}`,a,{headers:{Authorization:`Bearer ${t}`}}):await x.A.post("https://majesticmall.net/api/admin/addpromocode",a,{headers:{Authorization:`Bearer ${t}`}}),200===o.status&&(d.Ay.success(`Coupon ${M?"updated":"added"} successfully`),$(),T())}catch(a){console.error("Error saving coupon:",a),d.Ay.error("Failed to save coupon")}},layout:"vertical",children:[(0,Y.jsx)(r.A.Item,{name:"promocode",label:"Coupon Name",rules:[{required:!0,message:"Please input the coupon name!"}],children:(0,Y.jsx)(c.A,{})}),(0,Y.jsx)(r.A.Item,{name:"discountpercentage",label:"Discount (%)",rules:[{required:!0,message:"Please input the discount percentage!"}],children:(0,Y.jsx)(c.A,{type:"number"})}),(0,Y.jsx)(r.A.Item,{name:"startdate",label:"Start Date",rules:[{required:!0,message:"Please select the start date!"}],children:(0,Y.jsx)(p.A,{style:{width:"100%"}})}),(0,Y.jsx)(r.A.Item,{name:"enddate",label:"End Date",rules:[{required:!0,message:"Please select the end date!"}],children:(0,Y.jsx)(p.A,{style:{width:"100%"}})}),(0,Y.jsx)(r.A.Item,{children:(0,Y.jsxs)(l.Ay,{type:"primary",htmlType:"submit",children:[M?"Update":"Add"," Coupon"]})})]})})]})}},61966:(e,t,a)=>{a.d(t,{A:()=>l});var o=a(58168),n=a(65043);const s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};var r=a(22172),d=function(e,t){return n.createElement(r.A,(0,o.A)({},e,{ref:t,icon:s}))};const l=n.forwardRef(d)}}]);
//# sourceMappingURL=2706.ef1dd619.chunk.js.map