{"version":3,"file":"static/js/1655.1f642205.chunk.js","mappings":"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","sources":["components/admin/pages/Customers.js","../node_modules/@ant-design/icons-svg/es/asn/ExclamationCircleOutlined.js","../node_modules/@ant-design/icons/es/icons/ExclamationCircleOutlined.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Button, DatePicker, Input, Modal, Table, Space, message, Typography } from \"antd\";\r\nimport { ExclamationCircleOutlined, SearchOutlined } from \"@ant-design/icons\";\r\nimport axios from \"axios\";\r\nimport * as XLSX from \"xlsx\";\r\nimport moment from \"moment\";\r\nimport { toast, ToastContainer } from \"react-toastify\";\r\nimport { FileSpreadsheet } from \"lucide-react\";\r\nimport Cookies from 'js-cookie';\r\nimport CryptoJS from 'crypto-js';\r\n\r\nconst API_BASE_URL = \"https://majesticmall.net/api\";\r\nconst { Title } = Typography;\r\n\r\nconst Customers = () => {\r\n  const encryptionKey = process.env.REACT_APP_ENCRYPTION_KEY;\r\n  const encryptedToken = Cookies.get('token');\r\n  const token = encryptedToken ? CryptoJS.AES.decrypt(encryptedToken, encryptionKey).toString(CryptoJS.enc.Utf8) : null;\r\n\r\n  const [customers, setCustomers] = useState([]);\r\n  const [filteredCustomers, setFilteredCustomers] = useState([]);\r\n  const [searchText, setSearchText] = useState(\"\");\r\n  const [dateRange, setDateRange] = useState([null, null]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchCustomers();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (customers.length > 0) {\r\n      applyFilters();\r\n    }\r\n  }, [customers, searchText, dateRange]);\r\n\r\n  const fetchCustomers = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/user/getAllUser`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      if (response.status === 200) {\r\n        setCustomers(response.data.success);\r\n        setFilteredCustomers(transformData(response.data.success));\r\n      }\r\n    } catch (error) {\r\n      message.error(\"Failed to fetch customers\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleStatusChange = async (userId, action) => {\r\n    setLoading(true);\r\n    try {\r\n      const endpoint = action === 'block' ? 'changeBlockStatus' : 'changeunBlockStatus';\r\n      const response = await axios.get(`${API_BASE_URL}/user/${endpoint}/${userId}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      if (response.status === 200) {\r\n        toast.success(`User ${action === 'block' ? 'blocked' : 'unblocked'} successfully`);\r\n        fetchCustomers();\r\n      }\r\n    } catch (error) {\r\n      toast.error(\"Failed to change user status\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const showDeleteConfirm = (userId) => {\r\n    Modal.confirm({\r\n      title: 'Are you sure you want to delete this user?',\r\n      icon: <ExclamationCircleOutlined />,\r\n      content: 'This action cannot be undone.',\r\n      okText: 'Yes',\r\n      okType: 'danger',\r\n      cancelText: 'No',\r\n      onOk() {\r\n        deleteUser(userId);\r\n      },\r\n    });\r\n  };\r\n\r\n  const deleteUser = async (userId) => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await axios.delete(`${API_BASE_URL}/user/deleteUser/${userId}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      if (response.status === 200) {\r\n        toast.success(\"User deleted successfully\");\r\n        fetchCustomers();\r\n      }\r\n    } catch (error) {\r\n      toast.error(\"Failed to delete user\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const transformData = (data) => {\r\n    return data.map((item, index) => ({\r\n      key: item._id,\r\n      Sno: index + 1,\r\n      ID: item._id,\r\n      name: item.name,\r\n      email: item.email,\r\n      mobile: item.mobile,\r\n      Amobile: item.Amobile,\r\n      houseno: item.Houseno,\r\n      address1: item.address1,\r\n      address2: item.address2,\r\n      landmark: item.landmark,\r\n      pincode: item.pincode,\r\n      Status: item.status,\r\n      RegisteredDate: moment(item.createdAt).format(\"DD/MM/YYYY\"),\r\n      Date: item.createdAt,\r\n      action: (\r\n        <Space>\r\n          <Button\r\n            type={item.status === \"Approved\" ? \"primary\" : \"danger\"}\r\n            onClick={() => handleStatusChange(item._id, item.status === \"Approved\" ? \"block\" : \"unblock\")}\r\n          >\r\n            {item.status === \"Approved\" ? \"Block\" : \"Unblock\"}\r\n          </Button>\r\n          {/* <Button type=\"danger\" onClick={() => showDeleteConfirm(item._id)}>\r\n            Delete\r\n          </Button> */}\r\n        </Space>\r\n      ),\r\n    }));\r\n  };\r\n\r\n  const columns = [\r\n    { title: \"SNo\", dataIndex: \"Sno\", width: 80 },\r\n    { title: \"CustomerID\", dataIndex: \"ID\", width: 150 },\r\n    { title: \"Name\", dataIndex: \"name\", width: 150 },\r\n    { title: \"Email\", dataIndex: \"email\", width: 200 },\r\n    { title: \"Mobile\", dataIndex: \"mobile\", width: 150 },\r\n    { title: \"Alternative Mobile\", dataIndex: \"Amobile\", width: 150 },\r\n    { title: \"House No\", dataIndex: \"houseno\", width: 120 },\r\n    { title: \"Address 1\", dataIndex: \"address1\", width: 200 },\r\n    { title: \"Address 2\", dataIndex: \"address2\", width: 200 },\r\n    { title: \"Landmark\", dataIndex: \"landmark\", width: 150 },\r\n    { title: \"Pincode\", dataIndex: \"pincode\", width: 120 },\r\n    { title: \"Status\", dataIndex: \"Status\", width: 120 },\r\n    { title: \"Registered Date\", dataIndex: \"RegisteredDate\", width: 150 },\r\n    { title: \"Action\", dataIndex: \"action\", width: 200 },\r\n  ];\r\n\r\n  const applyFilters = () => {\r\n    let filteredData = customers;\r\n    if (searchText) {\r\n      filteredData = filteredData.filter((customer) =>\r\n        Object.values(customer).some((val) =>\r\n          val && typeof val === 'string' && val.toLowerCase().includes(searchText.toLowerCase())\r\n        )\r\n      );\r\n    }\r\n\r\n    // filteredData = filteredData.filter((record) => {\r\n    //   const startDate =\r\n    //     dateRange && dateRange[0] ? new Date(dateRange[0].startOf(\"day\").toDate()) : null;\r\n    //   const endDate =\r\n    //     dateRange && dateRange[1] ? new Date(dateRange[1].endOf(\"day\").toDate()) : null;\r\n    //   const recordDate = new Date(record.createdAt);\r\n\r\n    //   return (!startDate || recordDate >= startDate) && (!endDate || recordDate <= endDate);\r\n    // });\r\n\r\n    if (filteredData.length === 0) {\r\n      message.warning(\"No customers found with the applied filters.\");\r\n    }\r\n\r\n    setFilteredCustomers(filteredData);\r\n  };\r\n\r\n  const handleDateRangeChange = (dates) => {\r\n    setDateRange(dates);\r\n  };\r\n\r\n  const handleSearch = (value) => {\r\n    setSearchText(value);\r\n  };\r\n\r\n  const exportToExcel = () => {\r\n    const dataToExport = filteredCustomers.map(({ action, ...rest }) => rest);\r\n    const worksheet = XLSX.utils.json_to_sheet(dataToExport);\r\n    const workbook = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(workbook, worksheet, \"Customers\");\r\n    XLSX.writeFile(workbook, \"customers.xlsx\");\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <ToastContainer />\r\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 16 }}>\r\n        <Title level={3} className=\"title\">Customers</Title>\r\n        <Space>\r\n          <Input\r\n            placeholder=\"Search customers\"\r\n            prefix={<SearchOutlined />}\r\n            value={searchText}\r\n            onChange={(e) => handleSearch(e.target.value)}\r\n            style={{ width: 200 }}\r\n          />\r\n          <DatePicker.RangePicker\r\n            value={dateRange}\r\n            onChange={handleDateRangeChange}\r\n          />\r\n          <Button type=\"primary\" onClick={exportToExcel} icon={<FileSpreadsheet size={16} />}>\r\n            Export to Excel\r\n          </Button>\r\n        </Space>\r\n      </div>\r\n      <Table\r\n        columns={columns}\r\n        dataSource={filteredCustomers}\r\n        scroll={{ x: 'max-content' }}\r\n        pagination={{\r\n          pageSize: 10,\r\n          ////showSizeChanger: true,  \r\n        }}\r\n        components={{\r\n          header: {\r\n            cell: (props) => (\r\n              <th\r\n                {...props}\r\n                style={{\r\n                  ...props.style,\r\n                  background: \"linear-gradient(#000,#000,#000)\",\r\n                  color: \"white\",\r\n                }}\r\n              />\r\n            ),\r\n          }\r\n        }}\r\n        loading={loading}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Customers;","// This icon file is generated automatically.\nvar ExclamationCircleOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z\" } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z\" } }] }, \"name\": \"exclamation-circle\", \"theme\": \"outlined\" };\nexport default ExclamationCircleOutlined;\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\n\nimport * as React from 'react';\nimport ExclamationCircleOutlinedSvg from \"@ant-design/icons-svg/es/asn/ExclamationCircleOutlined\";\nimport AntdIcon from \"../components/AntdIcon\";\nvar ExclamationCircleOutlined = function ExclamationCircleOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _extends({}, props, {\n    ref: ref,\n    icon: ExclamationCircleOutlinedSvg\n  }));\n};\n\n/**![exclamation-circle](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTUxMiA2NEMyNjQuNiA2NCA2NCAyNjQuNiA2NCA1MTJzMjAwLjYgNDQ4IDQ0OCA0NDggNDQ4LTIwMC42IDQ0OC00NDhTNzU5LjQgNjQgNTEyIDY0em0wIDgyMGMtMjA1LjQgMC0zNzItMTY2LjYtMzcyLTM3MnMxNjYuNi0zNzIgMzcyLTM3MiAzNzIgMTY2LjYgMzcyIDM3Mi0xNjYuNiAzNzItMzcyIDM3MnoiIC8+PHBhdGggZD0iTTQ2NCA2ODhhNDggNDggMCAxMDk2IDAgNDggNDggMCAxMC05NiAwem0yNC0xMTJoNDhjNC40IDAgOC0zLjYgOC04VjI5NmMwLTQuNC0zLjYtOC04LThoLTQ4Yy00LjQgMC04IDMuNi04IDh2MjcyYzAgNC40IDMuNiA4IDggOHoiIC8+PC9zdmc+) */\nvar RefIcon = /*#__PURE__*/React.forwardRef(ExclamationCircleOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'ExclamationCircleOutlined';\n}\nexport default RefIcon;"],"names":["API_BASE_URL","Title","Typography","Customers","encryptedToken","Cookies","get","token","CryptoJS","decrypt","process","toString","Utf8","customers","setCustomers","useState","filteredCustomers","setFilteredCustomers","searchText","setSearchText","dateRange","setDateRange","loading","setLoading","useEffect","fetchCustomers","length","applyFilters","async","response","axios","headers","Authorization","status","data","success","transformData","error","message","map","item","index","key","_id","Sno","ID","name","email","mobile","Amobile","houseno","Houseno","address1","address2","landmark","pincode","Status","RegisteredDate","moment","createdAt","format","Date","action","_jsx","Space","children","Button","type","onClick","userId","endpoint","toast","handleStatusChange","filteredData","filter","customer","Object","values","some","val","toLowerCase","includes","warning","_jsxs","ToastContainer","style","display","justifyContent","alignItems","marginBottom","level","className","Input","placeholder","prefix","SearchOutlined","value","onChange","e","handleSearch","target","width","DatePicker","RangePicker","dates","exportToExcel","dataToExport","_ref","rest","worksheet","XLSX","json_to_sheet","workbook","book_new","book_append_sheet","icon","FileSpreadsheet","size","Table","columns","title","dataIndex","dataSource","scroll","x","pagination","pageSize","components","header","cell","props","background","color","ExclamationCircleOutlined","ref","React","AntdIcon","_extends","ExclamationCircleOutlinedSvg"],"sourceRoot":""}