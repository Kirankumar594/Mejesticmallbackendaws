"use strict";(self.webpackChunkfruit_app=self.webpackChunkfruit_app||[]).push([[5321],{45321:(e,t,i)=>{i.r(t),i.d(t,{default:()=>T});var s=i(65043),a=i(63336),r=i(12110),n=i(15316),l=i(68903),c=i(53193),o=i(79190),d=i(47715),u=i(32143),h=i(15795),x=i(11906),m=i(26494),A=i(17392),g=i(39336),j=i(71360),p=i(9855),v=i(50797),y=i(34535),b=i(68424),f=i(31517),S=i(80726),C=i.n(S),k=i(86213),P=i(78745),w=i(23927),R=i(1880),B=i(86111),N=i.n(B),W=i(70579);const{Title:D}=w.A,U=(0,y.Ay)(a.A)((e=>{let{theme:t}=e;return{border:`2px dashed ${t.palette.divider}`,padding:t.spacing(4),textAlign:"center",cursor:"pointer",marginBottom:t.spacing(2),"&:hover":{borderColor:t.palette.primary.main}}})),E=(0,y.Ay)(r.A)((e=>{let{theme:t}=e;return{marginBottom:t.spacing(1)}})),T=()=>{const[e,t]=(0,s.useState)([]),[i,y]=(0,s.useState)([]),[S,B]=(0,s.useState)([]),[T,z]=(0,s.useState)([]),I=R.A.get("token"),M=I?N().AES.decrypt(I,"Abhinanadan02").toString(N().enc.Utf8):null,[$,F]=(0,s.useState)(""),[_,O]=(0,s.useState)(""),[L,V]=(0,s.useState)(""),[q,Q]=(0,s.useState)(""),[G,H]=(0,s.useState)(""),[J,K]=(0,s.useState)(""),[X,Y]=(0,s.useState)(""),[Z,ee]=(0,s.useState)(""),[te,ie]=(0,s.useState)(""),[se,ae]=(0,s.useState)(""),[re,ne]=(0,s.useState)(""),[le,ce]=(0,s.useState)(""),[oe,de]=(0,s.useState)(""),[ue,he]=(0,s.useState)([]),[xe,me]=(0,s.useState)({value:"",price:"",units:"",stock:"",minStock:""}),[Ae,ge]=(0,s.useState)([]),[je,pe]=(0,s.useState)([]),{getRootProps:ve,getInputProps:ye}=(0,b.VB)({onDrop:e=>he([...ue,...e]),accept:"image/*,video/*"}),[be,fe]=(0,s.useState)({}),[Se,Ce]=(0,s.useState)({});console.log(be,Se,L,"subCategoryMap"),(0,s.useEffect)((()=>{(async()=>{try{var e,i;const s=await k.A.get("https://majesticmall.net/api/admin/getCategory",{headers:{Authorization:`Bearer ${M}`}});t(null===(e=s.data)||void 0===e?void 0:e.category.filter((e=>"Active"===e.status)));const a={};null===(i=s.data)||void 0===i||i.category.filter((e=>"Active"===e.status)).forEach((e=>{a[e._id]=e.categoryName})),fe(a)}catch(s){P.oR.error("Error fetching categories")}})(),(async()=>{try{var e,t;const i=await k.A.get("https://majesticmall.net/api/admin/getSubcategory",{headers:{Authorization:`Bearer ${M}`}});y(null===(e=i.data)||void 0===e?void 0:e.Subcategory.filter((e=>"Active"===e.status)));const s={};null===(t=i.data)||void 0===t||t.Subcategory.filter((e=>"Active"===e.status)).forEach((e=>{s[e._id]=e.SubcategoryName})),Ce(s)}catch(i){P.oR.error("Error fetching subcategories")}})(),(async()=>{try{var e;const t=await k.A.get("https://majesticmall.net/api/admin/getTag",{headers:{Authorization:`Bearer ${M}`}});B(null===(e=t.data)||void 0===e?void 0:e.Tag)}catch(t){P.oR.error("Error fetching tags")}})(),(async()=>{try{var e;const t=await k.A.get("https://majesticmall.net/api/admin/getUnit",{headers:{Authorization:`Bearer ${M}`}});z(null===(e=t.data)||void 0===e?void 0:e.Unit)}catch(t){P.oR.error("Error fetching units")}})()}),[M]);const ke=async e=>{const t=new FormData;try{for(const i of ue)t.append("id",e),t.append("Photos",i),await fetch("https://majesticmall.net/api/admin/addfruitsPhotos/",{method:"post",body:t},{headers:{Authorization:`Bearer ${M}`}});window.location.assign("/admindashboard/list-Fruits")}catch(i){P.oR.error("Error uploading images")}},Pe=(e,t)=>(e-e*t/100).toFixed(2);return(0,W.jsxs)(n.A,{sx:{p:3},children:[(0,W.jsx)(D,{level:3,className:"title",children:"Add Fruits and Vegetables"}),(0,W.jsxs)(l.Ay,{container:!0,spacing:3,children:[(0,W.jsx)(l.Ay,{item:!0,xs:12,children:(0,W.jsxs)(a.A,{sx:{p:3},children:[(0,W.jsx)(w.A,{variant:"h6",gutterBottom:!0,className:"mb-2",children:"Basic Information"}),(0,W.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,W.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,W.jsxs)(c.A,{fullWidth:!0,children:[(0,W.jsx)(o.A,{children:"Category"}),(0,W.jsxs)(d.A,{value:L,onChange:e=>V(e.target.value),label:"Category",children:[(0,W.jsx)(u.A,{value:"",children:"Select Category"}),e.map(((e,t)=>(0,W.jsx)(u.A,{value:e._id,children:e.categoryName},t)))]})]})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,W.jsxs)(c.A,{fullWidth:!0,children:[(0,W.jsx)(o.A,{children:"Sub-Category"}),(0,W.jsxs)(d.A,{value:q,onChange:e=>Q(e.target.value),label:"Sub-Category",children:[(0,W.jsx)(u.A,{value:"",children:"Select Sub-Category"}),i.filter((e=>e.categoryId===L)).map(((e,t)=>(0,W.jsx)(u.A,{value:e._id,children:e.SubcategoryName},t)))]})]})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,W.jsxs)(c.A,{fullWidth:!0,children:[(0,W.jsx)(o.A,{children:"Product Type"}),(0,W.jsxs)(d.A,{value:le,onChange:e=>ce(e.target.value),label:"Product Type",children:[(0,W.jsx)(u.A,{value:"",children:"Select Type"}),(0,W.jsx)(u.A,{value:"Normal",children:"Normal"}),(0,W.jsx)(u.A,{value:"Subscription",children:"Subscription"})]})]})})]})]})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,children:(0,W.jsxs)(a.A,{sx:{p:3},children:[(0,W.jsx)(w.A,{variant:"h6",gutterBottom:!0,className:"mb-2",children:"Product Details"}),(0,W.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,W.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,W.jsx)(h.A,{fullWidth:!0,label:"Product Title",value:$,onChange:e=>F(e.target.value)})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,W.jsx)(h.A,{fullWidth:!0,type:"number",label:"Product Price",value:_,onChange:e=>O(e.target.value)})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,W.jsxs)(c.A,{fullWidth:!0,children:[(0,W.jsx)(o.A,{children:"Product Tag"}),(0,W.jsxs)(d.A,{value:G,onChange:e=>H(e.target.value),label:"Product Tag",children:[(0,W.jsx)(u.A,{value:"",children:"Select Tag"}),S.map(((e,t)=>(0,W.jsx)(u.A,{value:e.tag,children:e.tag},t)))]})]})})]})]})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,children:(0,W.jsxs)(a.A,{sx:{p:3},children:[(0,W.jsx)(w.A,{variant:"h6",gutterBottom:!0,className:"mb-2",children:"Pricing Options"}),(0,W.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,W.jsx)(l.Ay,{item:!0,xs:12,md:6,children:(0,W.jsx)(h.A,{fullWidth:!0,type:"number",label:"Normal Member Discount (%)",value:J,onChange:e=>K(e.target.value)})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,md:6,children:(0,W.jsx)(h.A,{fullWidth:!0,type:"number",label:"Club Member Discount (%)",value:X,onChange:e=>Y(e.target.value)})})]}),(0,W.jsx)(n.A,{sx:{mt:3},children:(0,W.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,W.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,W.jsx)(h.A,{fullWidth:!0,type:"number",label:"Weight/Volume",value:xe.value,onChange:e=>me({...xe,value:e.target.value})})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,W.jsxs)(c.A,{fullWidth:!0,children:[(0,W.jsx)(o.A,{children:"Units"}),(0,W.jsxs)(d.A,{value:xe.units,onChange:e=>me({...xe,units:e.target.value}),label:"Units",children:[(0,W.jsx)(u.A,{value:"",children:"Select Units"}),T.map(((e,t)=>(0,W.jsx)(u.A,{value:e.unit,children:e.unit},t)))]})]})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,W.jsx)(h.A,{fullWidth:!0,type:"number",label:"Price",value:xe.price,onChange:e=>me({...xe,price:e.target.value})})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,W.jsx)(h.A,{fullWidth:!0,type:"number",label:"Stock Quantity",value:xe.stock,onChange:e=>me({...xe,stock:e.target.value})})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,W.jsx)(h.A,{fullWidth:!0,type:"number",label:"Min Stock Alert",value:xe.minStock,onChange:e=>me({...xe,minStock:e.target.value})})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,md:2,children:(0,W.jsx)(x.A,{variant:"contained",startIcon:(0,W.jsx)(j.A,{}),fullWidth:!0,onClick:()=>{if(xe.value&&xe.price&&xe.units&&J&&X){const e=Pe(Number(xe.price),Number(J)),t=Pe(Number(xe.price),Number(X)),i={...xe,discountedPrice:e,id:Date.now()},s={...xe,discountedPrice:t,id:Date.now()};ge([...Ae,i]),pe([...je,s]),me({value:"",price:"",units:"",stock:"",minStock:""})}else P.oR.info("Please fill in all option details and discounts")},sx:{height:"56px"},style:{backgroundColor:"#000"},children:"Add Option"})})]})}),Ae.length>0&&(0,W.jsxs)(n.A,{sx:{mt:3},children:[(0,W.jsx)(w.A,{variant:"subtitle1",gutterBottom:!0,children:"Normal Members Preview"}),Ae.map((e=>(0,W.jsx)(E,{children:(0,W.jsxs)(m.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,W.jsxs)(w.A,{children:[e.value," ",e.units," - Rs ",e.price," ","(Discounted: Rs ",e.discountedPrice,")",(0,W.jsx)("br",{}),(0,W.jsxs)("small",{children:["Stock: ",e.stock," | Min Stock Alert:"," ",e.minStock]})]}),(0,W.jsx)(A.A,{onClick:()=>{return t=e.id,void ge(Ae.filter((e=>e.id!==t)));var t},color:"error",children:(0,W.jsx)(p.A,{})})]})},e.id)))]}),je.length>0&&(0,W.jsxs)(n.A,{sx:{mt:3},children:[(0,W.jsxs)(w.A,{variant:"subtitle1",gutterBottom:!0,children:["Club Members Preview",(0,W.jsx)(g.A,{sx:{my:1}})]}),je.map((e=>(0,W.jsx)(E,{children:(0,W.jsxs)(m.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,W.jsxs)(n.A,{children:[(0,W.jsxs)(w.A,{variant:"subtitle2",children:[e.value," ",e.units]}),(0,W.jsxs)(w.A,{color:"textSecondary",children:["Original Price: Rs ",e.price]}),(0,W.jsxs)(w.A,{color:"primary",children:["Club Discounted Price: Rs ",e.discountedPrice]}),(0,W.jsxs)(w.A,{variant:"body2",color:"textSecondary",children:["Stock: ",e.stock," | Min Stock Alert:"," ",e.minStock]})]}),(0,W.jsx)(A.A,{onClick:()=>{return t=e.id,void pe(je.filter((e=>e.id!==t)));var t},color:"error",children:(0,W.jsx)(p.A,{})})]})},e.id)))]})]})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,children:(0,W.jsxs)(a.A,{sx:{p:3},children:[(0,W.jsx)(w.A,{variant:"h6",gutterBottom:!0,children:"Product Description"}),(0,W.jsx)(f.aF,{editor:C(),data:oe,onChange:(e,t)=>{const i=t.getData();de(i)}})]})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,children:(0,W.jsxs)(a.A,{sx:{p:3},children:[(0,W.jsx)(w.A,{variant:"h6",gutterBottom:!0,children:"Product Images"}),(0,W.jsxs)(U,{...ve(),children:[(0,W.jsx)("input",{...ye()}),(0,W.jsx)(v.A,{size:40,className:"mx-auto mb-2"}),(0,W.jsx)(w.A,{children:"Drag & drop files here, or click to select files"}),(0,W.jsx)(w.A,{variant:"body2",color:"textSecondary",children:"Supports images and videos"})]}),ue.length>0&&(0,W.jsx)(l.Ay,{container:!0,spacing:2,children:ue.map(((e,t)=>(0,W.jsx)(l.Ay,{item:!0,xs:6,sm:4,md:3,children:(0,W.jsx)(r.A,{children:(0,W.jsxs)(n.A,{sx:{position:"relative"},children:[e.type.startsWith("video/")?(0,W.jsx)("video",{src:URL.createObjectURL(e),controls:!0,style:{width:"100%",height:"200px",objectFit:"cover"}}):(0,W.jsx)(n.A,{component:"img",src:URL.createObjectURL(e),alt:`Upload ${t+1}`,sx:{width:"100%",height:"200px",objectFit:"cover"}}),(0,W.jsx)(A.A,{sx:{position:"absolute",top:8,right:8,backgroundColor:"rgba(255, 255, 255, 0.8)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.9)"}},onClick:()=>{const e=[...ue];e.splice(t,1),he(e)},children:(0,W.jsx)(p.A,{size:20})})]})})},t)))})]})}),(0,W.jsx)(l.Ay,{item:!0,xs:12,children:(0,W.jsx)(n.A,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,W.jsx)(x.A,{variant:"contained",size:"large",onClick:async()=>{if($&&_&&oe&&L&&q&&G)if(0!==Ae.length&&0!==je.length)if(ue.length<1)P.oR.info("Please add at least one image");else try{const t={productname:$,price:_,description:oe,category:L,subcategory:q,tag:G,discount:J,clubdiscount:X,stock:Z,unit:se,miniunit:re,ministock:te,weight:Ae,subscribe:le,Clubweight:je},i=await k.A.post("https://majesticmall.net/api/admin/addfruits",t,{headers:{Authorization:`Bearer ${M}`}});var e;if(200===i.status)await ke(null===(e=i.data.fruits)||void 0===e?void 0:e._id),P.oR.success("Product added successfully")}catch(s){var t,i;P.oR.error((null===(t=s.response)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.error)||"Error adding product")}else P.oR.info("Please add weight and price options for both normal and club members");else P.oR.info("Please fill in all required fields.")},startIcon:(0,W.jsx)(j.A,{}),style:{backgroundColor:"#000"},children:"Add Product"})})})]})]})}}}]);
//# sourceMappingURL=5321.183a74cb.chunk.js.map