"use strict";(self.webpackChunkfruit_app=self.webpackChunkfruit_app||[]).push([[5191],{45191:(e,t,a)=>{a.r(t),a.d(t,{default:()=>I});var r=a(65043),s=a(23927),c=a(46909),o=a(59748),i=a(22019),l=a(6051),n=a(3188),u=a(27210),y=a(49757),d=a(94434),g=a(62058),m=a(75337),A=a(26533),h=a(9855),b=a(1457),p=a(86213),S=a(11238),x=a(1880),j=a(86111),C=a.n(j),N=a(70579);const{Title:f}=s.A,k="https://majesticmall.net/api/admin",{confirm:v}=c.A,I=()=>{const[e,t]=(0,r.useState)([]),[a,s]=(0,r.useState)([]),[j,I]=(0,r.useState)(!1),[_,w]=(0,r.useState)(!1),[$,F]=(0,r.useState)(null),[z]=o.A.useForm(),[E,T]=(0,r.useState)(""),[B,P]=(0,r.useState)({current:1,pageSize:10}),[q,O]=(0,r.useState)([]),U=e.length,W=x.A.get("token"),L=W?C().AES.decrypt(W,"Abhinanadan02").toString(C().enc.Utf8):null,[K,V]=(0,r.useState)({});(0,r.useEffect)((()=>{Promise.all([Y(),D()])}),[]),(0,r.useEffect)((()=>{const e={};a.forEach((t=>{e[t._id]=t.categoryName})),V(e)}),[a]),(0,r.useEffect)((()=>{const t=e.map((e=>({...e,categoryName:K[e.categoryId]||"Unknown Category"})));O(t.filter((e=>Object.values(e).some((e=>e&&e.toString().toLowerCase().includes(E.toLowerCase()))))))}),[e,K,E]);const Y=async()=>{try{const e=await p.A.get(`${k}/getSubcategory`);t(e.data.Subcategory)}catch(e){i.Ay.error("Failed to fetch sub-categories")}},D=async()=>{try{const e=await p.A.get(`${k}/getCategory`);s(e.data.category)}catch(e){i.Ay.error("Failed to fetch categories")}},G=async e=>{try{await p.A.delete(`${k}/deleteSubcategory/${e}`,{headers:{Authorization:`Bearer ${L}`}}),i.Ay.success("Sub-category deleted successfully"),Y()}catch(t){i.Ay.error("Failed to delete sub-category")}},H=[{title:"Serial No.",key:"serialNo",render:(e,t,a)=>(B.current-1)*B.pageSize+a+1},{title:"Category Name",dataIndex:"categoryName",key:"categoryName"},{title:`Sub-Category Name (${U})`,dataIndex:"SubcategoryName",key:"SubcategoryName"},{title:"Action",key:"action",render:(e,t)=>(0,N.jsxs)(l.A,{children:[(0,N.jsx)(n.Ay,{type:"text",icon:(0,N.jsx)(A.A,{color:"blue"}),onClick:()=>{F(t),w(!0),z.setFieldsValue({categoryId:t.categoryId,SubcategoryName:t.SubcategoryName})}}),(0,N.jsx)(n.Ay,{type:"text",icon:(0,N.jsx)(h.A,{color:"red"}),onClick:()=>{return e=t._id,void v({title:"Are you sure you want to delete?",content:"This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk(){G(e)},onCancel(){}});var e}}),(0,N.jsx)(n.Ay,{type:"Active"===t.status?"primary":"danger",onClick:()=>(async e=>{try{const t="Active"===e.status?"changesubcategoryActiveStatus":"changesubcategoryInactiveStatus";await p.A.get(`https://majesticmall.net/api/admin/${t}/${e._id}`,{headers:{Authorization:`Bearer ${L}`}}),i.Ay.success(`SubCategory ${"Active"===e.status?"blocked":"unblocked"} successfully`),Y()}catch(t){i.Ay.error("Failed to update product status")}})(t),children:"Active"===t.status?"Active":"Inactive"})]})}];return(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[(0,N.jsx)(f,{level:3,className:"title",children:"Sub-Categories"}),(0,N.jsxs)(l.A,{children:[(0,N.jsx)(u.A,{placeholder:"Search sub-categories",prefix:(0,N.jsx)(g.A,{}),value:E,onChange:e=>T(e.target.value)}),(0,N.jsx)(n.Ay,{type:"primary",icon:(0,N.jsx)(m.A,{}),onClick:()=>I(!0),children:"Add Sub-Category"}),(0,N.jsx)(n.Ay,{type:"primary",icon:(0,N.jsx)(b.A,{size:16}),onClick:()=>{const e=q.map((e=>{let{categoryName:t,SubcategoryName:a}=e;return{"Category Name":t,"Sub-Category Name":a}})),t=S.Wp.json_to_sheet(e),a=S.Wp.book_new();S.Wp.book_append_sheet(a,t,"Sub-Categories"),S._h(a,"sub-categories.xlsx")},children:"Export to Excel"})]})]}),(0,N.jsx)(y.A,{columns:H,dataSource:q,rowKey:"_id",pagination:{...B,onChange:(e,t)=>{P({current:e,pageSize:t})}},scroll:{x:"max-content"},components:{header:{cell:e=>(0,N.jsx)("th",{...e,style:{...e.style,background:"linear-gradient(#000,#000,#000)",color:"white"}})}}}),(0,N.jsx)(c.A,{title:"Add Sub-Category",visible:j,onCancel:()=>I(!1),footer:null,children:(0,N.jsxs)(o.A,{form:z,onFinish:async e=>{try{await p.A.post(`${k}/addSubcategory`,{categoryId:e.categoryId,SubcategoryName:e.SubcategoryName},{headers:{Authorization:`Bearer ${L}`}}),i.Ay.success("Sub-category added successfully"),I(!1),z.resetFields(),Y()}catch(t){i.Ay.error("Failed to add sub-category")}},layout:"vertical",children:[(0,N.jsx)(o.A.Item,{name:"categoryId",label:"Category Name",rules:[{required:!0,message:"Please select a category"}],children:(0,N.jsx)(d.A,{placeholder:"Select a category",children:a.map((e=>(0,N.jsx)(d.A.Option,{value:e._id,children:e.categoryName},e._id)))})}),(0,N.jsx)(o.A.Item,{name:"SubcategoryName",label:"Sub-Category Name",rules:[{required:!0,message:"Please enter a sub-category name"}],children:(0,N.jsx)(u.A,{})}),(0,N.jsx)(o.A.Item,{children:(0,N.jsx)(n.Ay,{type:"primary",htmlType:"submit",children:"Add Sub-Category"})})]})}),(0,N.jsx)(c.A,{title:"Edit Sub-Category",visible:_,onCancel:()=>w(!1),footer:null,children:(0,N.jsxs)(o.A,{form:z,onFinish:async e=>{try{await p.A.post(`${k}/editSubcategory/${$._id}`,{categoryId:e.categoryId,SubcategoryName:e.SubcategoryName},{headers:{Authorization:`Bearer ${L}`}}),i.Ay.success("Sub-category updated successfully"),w(!1),z.resetFields(),Y()}catch(t){i.Ay.error("Failed to update sub-category")}},layout:"vertical",children:[(0,N.jsx)(o.A.Item,{name:"categoryId",label:"Category Name",rules:[{required:!0,message:"Please select a category"}],children:(0,N.jsx)(d.A,{placeholder:"Select a category",children:a.map((e=>(0,N.jsx)(d.A.Option,{value:e._id,children:e.categoryName},e._id)))})}),(0,N.jsx)(o.A.Item,{name:"SubcategoryName",label:"Sub-Category Name",rules:[{required:!0,message:"Please enter a sub-category name"}],children:(0,N.jsx)(u.A,{})}),(0,N.jsx)(o.A.Item,{children:(0,N.jsx)(n.Ay,{type:"primary",htmlType:"submit",children:"Update Sub-Category"})})]})})]})}}}]);
//# sourceMappingURL=5191.aa6a345a.chunk.js.map