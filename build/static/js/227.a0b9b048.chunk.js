"use strict";(self.webpackChunkfruit_app=self.webpackChunkfruit_app||[]).push([[227],{10227:(e,t,a)=>{a.r(t),a.d(t,{default:()=>I});var n=a(65043),l=a(23927),r=a(46909),s=a(59748),i=a(22019),d=a(3188),o=a(6051),c=a(27210),u=a(49757),h=a(76191),m=a(62058),y=a(86213),p=a(1880),A=a(86111),x=a.n(A),v=a(70579);const{Title:g}=l.A,j="https://majesticmall.net/api/user",{confirm:f}=r.A,I=()=>{const[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(!1),[A,f]=(0,n.useState)(!1),[I,b]=(0,n.useState)(null),[w,k]=(0,n.useState)([]),[S]=s.A.useForm(),C=p.A.get("token"),F=C?x().AES.decrypt(C,"Abhinanadan02").toString(x().enc.Utf8):null;(0,n.useEffect)((()=>{F&&(D(),console.log("calling"))}),[F]);const[$,W]=(0,n.useState)([]),D=async()=>{try{const e=await y.A.get(`${j}/all-wallets`,{headers:{Authorization:`Bearer ${F}`}});t(e.data.success),W(e.data.success)}catch(e){i.Ay.error("Failed to fetch users")}};console.log("users=====",e);const T=[{title:"Name",dataIndex:"userId",key:"userId.name",render:e=>(null===e||void 0===e?void 0:e.name)||"N/A"},{title:"Mobile",dataIndex:"userId",key:"userId.mobile",render:e=>(null===e||void 0===e?void 0:e.mobile)||"N/A"},{title:"Wallet Balance",dataIndex:"balance",render:(e,t)=>{var a;return(0,v.jsx)("span",{style:{color:t.balance>0?"green":"red"},children:null===t||void 0===t||null===(a=t.balance)||void 0===a?void 0:a.toFixed(2)})}},{title:"Actions",key:"actions",render:(e,t)=>(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(d.Ay,{icon:(0,v.jsx)(h.A,{}),onClick:()=>{var e;k(null===t||void 0===t||null===(e=t.transactions)||void 0===e?void 0:e.reverse()),l(!0)},style:{marginRight:8},children:"View Transactions"})})}];return(0,v.jsxs)("div",{children:[(0,v.jsx)(g,{level:3,children:"Wallet Management"}),(0,v.jsx)(o.A,{children:(0,v.jsx)(c.A,{placeholder:"Search customers",prefix:(0,v.jsx)(m.A,{}),onChange:e=>(e=>{if(!$||0===$.length)return;let a=$.filter((t=>{var a;return(null===t||void 0===t||null===(a=t.userId)||void 0===a?void 0:a.name)&&"string"===typeof t.userId.name&&t.userId.name.toLowerCase().includes(e.toLowerCase())}));t(a.length>0?a:$)})(e.target.value),style:{width:200}})}),(0,v.jsx)(u.A,{columns:T,dataSource:e,rowKey:"_id",pagination:{pageSize:10}}),(0,v.jsx)(r.A,{title:"User Transactions",visible:a,onCancel:()=>l(!1),footer:null,width:800,children:(0,v.jsx)(u.A,{columns:[{title:"Date",dataIndex:"date",key:"date",render:e=>new Date(e).toLocaleDateString()},{title:"Amount",dataIndex:"amount",key:"amount",render:(e,t)=>{const a=t.credit>0?t.credit:t.debit,n=t.credit>0;return(0,v.jsx)("span",{style:{color:n?"green":"red",fontWeight:"bold"},children:n?`+${a.toFixed(2)}`:`-${a.toFixed(2)}`})}},{title:"Type",dataIndex:"type",key:"type",render:(e,t)=>(0,v.jsx)("span",{style:{color:t.credit>0?"green":"red"},children:t.credit>0?"Credit":"Debit"})},{title:"Detail",dataIndex:"detail",key:"detail"}],dataSource:w,rowKey:"_id"})}),(0,v.jsx)(r.A,{title:`Update Wallet - ${null===I||void 0===I?void 0:I.name}`,visible:A,onCancel:()=>f(!1),footer:null,children:(0,v.jsxs)(s.A,{form:S,onFinish:async e=>{try{await y.A.post(`${j}/updatewallet`,{userId:I._id,amount:e.amount,type:e.type},{headers:{Authorization:`Bearer ${F}`}}),i.Ay.success("Wallet updated successfully"),f(!1),S.resetFields(),D()}catch(t){i.Ay.error("Failed to update wallet")}},layout:"vertical",children:[(0,v.jsx)(s.A.Item,{name:"amount",label:"Amount",rules:[{required:!0,message:"Please enter an amount"}],children:(0,v.jsx)(c.A,{type:"number"})}),(0,v.jsx)(s.A.Item,{name:"type",hidden:!0,children:(0,v.jsx)(c.A,{})}),(0,v.jsx)(s.A.Item,{children:(0,v.jsx)(d.Ay,{type:"primary",htmlType:"submit",children:"Update Wallet"})})]})})]})}}}]);
//# sourceMappingURL=227.a0b9b048.chunk.js.map