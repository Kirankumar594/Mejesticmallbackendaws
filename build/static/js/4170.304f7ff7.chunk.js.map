{"version":3,"file":"static/js/4170.304f7ff7.chunk.js","mappings":"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","sources":["components/admin/pages/Driverleaves.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Table, Input, Button, Typography, Space } from \"antd\";\r\nimport axios from \"axios\";\r\nimport * as XLSX from \"xlsx\";\r\nimport moment from \"moment\";\r\nimport { FileDown, FileSpreadsheet, Search } from \"lucide-react\";\r\nimport { toast } from \"react-toastify\";\r\nimport Cookies from 'js-cookie';\r\nimport CryptoJS from 'crypto-js';\r\n\r\nconst { Title } = Typography;\r\n\r\nconst Leaves = () => {\r\n  const encryptionKey = process.env.REACT_APP_ENCRYPTION_KEY;\r\n  const encryptedToken = Cookies.get('token');\r\n  const token = encryptedToken ? CryptoJS.AES.decrypt(encryptedToken, encryptionKey).toString(CryptoJS.enc.Utf8) : null;\r\n  const [data, setData] = useState([]);\r\n  const [filteredData, setFilteredData] = useState([]);\r\n\r\n  useEffect(() => {\r\n    getLeaves();\r\n  }, []);\r\n\r\n  const getLeaves = async () => {\r\n    try {\r\n      const res = await axios.get(\r\n        \"https://majesticmall.net/api/user/getAllleaves\"\r\n      );\r\n      if (res.status === 200) {\r\n        const transformedData = transformData(res.data.success);\r\n        setData(transformedData);\r\n        setFilteredData(transformedData);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching leaves:\", error);\r\n    }\r\n  };\r\n\r\n  const transformData = (data) => {\r\n    return data.map((item, i) => ({\r\n      key: i + 1,\r\n      _id: item._id,\r\n      userName: item.userName,\r\n      fromDate: moment(item.FromDate).format(\"YYYY-MM-DD\"),\r\n      toDate: moment(item.ToDate).format(\"YYYY-MM-DD\"),\r\n      leaveType: item.LeaveType,\r\n      status: item.status,\r\n    }));\r\n  };\r\n\r\n  const handleSearch = (e) => {\r\n    const searchText = e.target.value.toLowerCase();\r\n    const filtered = data.filter((item) =>\r\n      Object.values(item).some(\r\n        (val) =>\r\n          typeof val === \"string\" && val.toLowerCase().includes(searchText)\r\n      )\r\n    );\r\n    setFilteredData(filtered);\r\n  };\r\n\r\n  const handleApproveLeave = async (leaveId) => {\r\n    try {\r\n      axios.post(\r\n        \"https://majesticmall.net/api/user/changeleavesStatus\",\r\n        {\r\n          leavesId: leaveId,\r\n          status: \"Approved\",\r\n        },\r\n\r\n      ).then(function (response) {\r\n        if (response.status === 200) {\r\n          toast.info(\"Approved successfully\");\r\n          window.location.reload();\r\n        }\r\n      })\r\n        .catch(function (error) {\r\n          window.location.reload();\r\n        });\r\n    } catch (error) {\r\n      console.warn(error);\r\n      window.location.reload();\r\n      return error;\r\n    };\r\n  }\r\n\r\n  const handleRejectLeave = async (leaveId) => {\r\n    try {\r\n      await axios.post(\r\n        \"https://majesticmall.net/api/user/changeleavesStatus\",\r\n        {\r\n          leavesId: leaveId,\r\n          status: \"Rejected\",\r\n        }\r\n\r\n\r\n      ).then(function (response) {\r\n        if (response.status === 200) {\r\n          toast.info(\"Rejected successfully\");\r\n          window.location.reload();\r\n        }\r\n      })\r\n        .catch(function (error) {\r\n          window.location.reload();\r\n        });\r\n    } catch (error) {\r\n      console.warn(error);\r\n      window.location.reload();\r\n      return error;\r\n    };\r\n  }\r\n\r\n  const handleExportToExcel = () => {\r\n    const worksheet = XLSX.utils.json_to_sheet(filteredData);\r\n    const workbook = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(workbook, worksheet, \"Leaves\");\r\n    XLSX.writeFile(workbook, \"LeavesData.xlsx\");\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      title: \"Driver Name\",\r\n      dataIndex: \"userName\",\r\n      key: \"userName\",\r\n    },\r\n    {\r\n      title: \"From Date\",\r\n      dataIndex: \"fromDate\",\r\n      key: \"fromDate\",\r\n    },\r\n    {\r\n      title: \"To Date\",\r\n      dataIndex: \"toDate\",\r\n      key: \"toDate\",\r\n    },\r\n    {\r\n      title: \"Leave Type\",\r\n      dataIndex: \"leaveType\",\r\n      key: \"leaveType\",\r\n    },\r\n    {\r\n      title: \"Status\",\r\n      dataIndex: \"status\",\r\n      key: \"status\",\r\n    },\r\n    {\r\n      title: \"Action\",\r\n      render: (record) => (\r\n        <>\r\n          {record.status !== \"Approved\" &&\r\n            (record.status !== \"Rejected\" && (\r\n              <>\r\n                {\" \"}\r\n                <Button\r\n                  type=\"primary\"\r\n                  onClick={() => handleApproveLeave(record._id)}\r\n                  style={{ marginRight: \"10px\", backgroundColor: \"green\" }}\r\n                >\r\n                  Approve\r\n                </Button>\r\n                <Button\r\n                  type=\"danger\"\r\n                  onClick={() => handleRejectLeave(record._id)}\r\n                  style={{ backgroundColor: \"red\", color: \"white\" }}\r\n                >\r\n                  Reject\r\n                </Button>{\" \"}\r\n              </>\r\n            ))}\r\n        </>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div>\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          justifyContent: \"space-between\",\r\n          alignItems: \"center\",\r\n          marginBottom: 16,\r\n        }}\r\n      >\r\n        <Title level={3}>Leaves</Title>\r\n        <Space>\r\n          <Input\r\n            placeholder=\"Search\"\r\n            onChange={handleSearch}\r\n            prefix={<Search size={16} />}\r\n          />\r\n          <Button\r\n            type=\"primary\"\r\n            onClick={handleExportToExcel}\r\n            icon={<FileSpreadsheet size={16} />}\r\n          >\r\n            Export to Excel\r\n          </Button>\r\n        </Space>\r\n      </div>\r\n\r\n      <Table\r\n        columns={columns}\r\n        dataSource={filteredData}\r\n        pagination={{\r\n          pageSize: 10,\r\n          //showSizeChanger: true, \r\n        }}\r\n        scroll={{ x: \"max-content\" }}\r\n        components={{\r\n          header: {\r\n            cell: (props) => (\r\n              <th\r\n                {...props}\r\n                style={{\r\n                  ...props.style,\r\n                  background: \"linear-gradient(#000,#000,#000)\",\r\n                  color: \"white\",\r\n                }}\r\n              />\r\n            ),\r\n          },\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Leaves;\r\n"],"names":["Title","Typography","Leaves","encryptedToken","Cookies","get","data","setData","CryptoJS","decrypt","process","toString","Utf8","useState","filteredData","setFilteredData","useEffect","getLeaves","async","res","axios","status","transformedData","transformData","success","error","console","map","item","i","key","_id","userName","fromDate","moment","FromDate","format","toDate","ToDate","leaveType","LeaveType","columns","title","dataIndex","render","record","_jsx","_Fragment","children","_jsxs","Button","type","onClick","post","leavesId","leaveId","then","response","toast","info","window","location","reload","catch","warn","handleApproveLeave","style","marginRight","backgroundColor","handleRejectLeave","color","display","justifyContent","alignItems","marginBottom","level","Space","Input","placeholder","onChange","e","searchText","target","value","toLowerCase","filtered","filter","Object","values","some","val","includes","prefix","Search","size","handleExportToExcel","worksheet","XLSX","json_to_sheet","workbook","book_new","book_append_sheet","icon","FileSpreadsheet","Table","dataSource","pagination","pageSize","scroll","x","components","header","cell","props","background"],"sourceRoot":""}